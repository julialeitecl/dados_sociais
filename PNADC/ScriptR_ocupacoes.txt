library(PNADcIBGE)
library(survey)
library(tidyverse)
library(srvyr)
library(openxlsx)


# 2022
#----
PNADc2022 <- get_pnadc(year = 2022, quarter = 4, vars = c("V1022", "V2007", "V4010", "VD4001", "VD4002", "VD4003", "VD4004A", "VD4011")) # abrindo a base

ocupacoes_cbo_2022 <- svyby(~VD4011, by = ~UF, PNADc2022, svytotal, na.rm = TRUE)
rm(PNADc2022)
gc()

ocupacoesporsexocbo_2022 <- svyby(~interaction(V2007,VD4011), by = ~UF, PNADc2022, svytotal, na.rm = TRUE)
rm(ocupacoes_cbo_2022)

# Organizando colunas

ocupacoesporsexocbo_2022 <-
  ocupacoesporsexocbo_2022[ order(ocupacoesporsexocbo_2022$UF), c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)]
names(ocupacoesporsexocbo_2022) <- c("UF","Diretores e gerentes_homem 2022","Diretores e gerentes_mulher 2022","Profissionais das ciências e intelectuais_homem 2022","Profissionais das ciências e intelectuais_mulher 2022",
                                     "Técnicos e profissionais de nível médio_homem 2022","Técnicos e profissionais de nível médio_mulher 2022","Trabalhadores de apoio administrativo_homem 2022",
                                     "Trabalhadores de apoio administrativo_mulher 2022", "Trabalhadores dos serviços, vendedores dos comércios e mercados_homem 2022","Trabalhadores dos serviços, vendedores dos comércios e mercados_mulher 2022",
                                     "Trabalhadores qualificados da agropecuária, florestais, da caça e da pesca_homem 2022","Trabalhadores qualificados da agropecuária, florestais, da caça e da pesca_mulher 2022",
                                     "Trabalhadores qualificados, operários e artesões da construção, das artes mecânicas e outros ofícios_homem 2022","Trabalhadores qualificados, operários e artesões da construção, das artes mecânicas e outros ofícios_mulher 2022",
                                     "Operadores de instalações e máquinas e montadores_homem 2022", "Operadores de instalações e máquinas e montadores_mulher 2022", "Ocupações elementares_homem 2022", "Ocupações elementares_mulher 2022",
                                     "Membros das forças armadas, policiais e bombeiros militares_homem 2022", "Membros das forças armadas, policiais e bombeiros militares_mulher 2022", "Ocupações maldefinidas_homem 2022", "Ocupações maldefinidas_mulher 2022")

setwd("C:/Users/carla.cutrim/Desktop/Cargos de liderança_2022") 

write.xlsx(ocupacoesporsexocbo_2022, 'ocupacoesCBO_2022.xlsx')

